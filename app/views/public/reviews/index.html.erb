  <% @orders.each do |order| %>
    <% order.order_details.select(:item_id).distinct.each do |order_detail| %>
      <br>
      <%= image_tag order_detail.item.get_item_images.first.variant(resize: "150x150").processed %>
      <br>
      <%= link_to item_path(order_detail.item_id) do %>
        <%= order_detail.item.name %>
      <% end %><br>
      ¥<%= order_detail.item.price.to_s(:delimited) %><br>
      <% unless current_customer.reviews.find_by(params[:item_id]) %>
        <%= form_with model: @review, url: reviews_path, method: :post do |f| %>
          <%= render 'review_error', review: @review %>
          <%= f.label "レビューコメント" %><br>
          <%= f.text_field :review_comment, autofocus: true, autocomplete: "review_comment", placeholder: "レビューコメント" %><br>
          <%= f.submit "新規登録" %>

        <div class="form-group row" id="star">
          <%= f.label :star,'評価 ', class:'col-md-3 col-form-label' %>
          <%= f.hidden_field :star, id: :review_star %>
        </div>
        <!-- 評価javascript -->
        <script>
        $('#star').raty({
          size     : 36,
          starOff:  '<%= asset_path('star-off.png') %>',
          starOn : '<%= asset_path('star-on.png') %>',

          scoreName: 'review[star]',
          half: false,
        });
        </script>

        <% end %>
      <% else %>

        <div class=card>
          <p>内容:<%= review.review_comment %></p>
          <p>評価 :<%= review.star%>点</p>
          <div id="star-rate<%= review.id%>"></div>
          <script>
            $('#star-rate<%= review.id%>').raty({
              size      : 36,
              starOff   : '<%= asset_path('star-off.png') %>',
              starOn    : '<%= asset_path('star-on.png') %>',
              half      : false,
              readOnly: true,
              score: <%= review.star %>,
            });
          </script>
        </div>
      <% end %>
    <% end %>
  <% end %>
